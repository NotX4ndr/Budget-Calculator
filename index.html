<!DOCTYPE html> 
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora Presupuestos Iberdrola</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <div class="card">
            <div class="header">
                <div class="header-title">
                    <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="4" y="4" width="16" height="16" rx="2" ry="2" />
                        <line x1="8" y1="12" x2="16" y2="12" />
                        <line x1="12" y1="8" x2="12" y2="16" />
                    </svg>
                    <h1>Calculadora de Presupuestos</h1>
                </div>
                <p class="header-subtitle">· Smart Mobility Hogar ·</p>
            </div>
            <main class="content">
                <div class="grid">
                    <div class="section">
                        <h2 class="section-title">Configuración</h2>

                        <div class="box">
                            <label for="selectInstalacion" class="label">Tipo de instalación</label>
                            <select id="selectInstalacion" class="select" onchange="setTipoInstalacion(this.value)">
                                <option value="none" selected>Seleccionar tipo de vivienda</option>
                                <option value="uni">Vivienda unifamiliar</option>
                                <option value="com_mismo">Garaje comunitario en mismo edificio</option>
                                <option value="com_distinto">Garaje comunitario en distinto edificio</option>
                                <option value="uni_gdp">Vivienda unifamiliar + GDP</option>
                                <option value="com_mismo_gdp">Garaje comunitario en mismo edificio + GDP</option>
                            </select>
                            <p class="helper-text">En las variantes “+ GDP”, el gestor dinámico va incluido en el precio del paquete de instalación.</p>
                        </div>

                        <div class="box">
                            <div class="label">Cargador</div>
                            <div class="button-grid">
                                <button class="btn" id="btnVestel" onclick="setCargador('vestel')">
                                    <div>Vestel</div>
                                    <div class="btn-subtitle">Económico</div>
                                </button>
                                <button class="btn active-purple" id="btnPulsar" onclick="setCargador('pulsar')">
                                    <div>Pulsar Max</div>
                                    <div class="btn-subtitle">Premium</div>
                                </button>
                            </div>

                            <div id="pulsarPhaseWrapper" class="hidden">
                                <p class="label label-subtitle">Fases del Pulsar Max</p>
                                <div class="phase-grid">
                                    <button type="button" id="btnMono" class="phase-btn active" onclick="setFase('mono')">Monofásico 7,4 kW</button>
                                    <button type="button" id="btnTri" class="phase-btn" onclick="setFase('tri')">Trifásico 22 kW</button>
                                </div>
                                <span id="triBadge" class="badge-tri hidden" role="status" aria-live="polite">Instalación trifásica: presupuesto a medida</span>
                            </div>
                            <div class="charger-info-header">
                                <span class="muted-caption">Más información sobre los equipos</span>
                                <div class="chip-group">
                                    <button type="button" class="chip-btn" id="chipVestel" onmouseover="showChargerInfo('vestel')" onclick="showChargerInfo('vestel')">Detalles Vestel</button>
                                    <button type="button" class="chip-btn" id="chipPulsar" onmouseover="showChargerInfo('pulsar')" onclick="showChargerInfo('pulsar')">Detalles Pulsar Max</button>
                                </div>
                            </div>
                            <div id="chargerInfoBox" class="info-detail-box"></div>
                        </div>

                        <div class="warning-box hidden" id="avisoGarajeDistinto" role="status" aria-live="polite">
                            <span class="checkbox-title">Garaje comunitario en distinto edificio</span>
                            <p class="checkbox-desc warning-text">Requiere presupuesto in situ. Contactaremos para coordinar una visita técnica.</p>
                        </div>

                        <div class="info-box">
                            <label class="checkbox-box">
                                <input type="checkbox" id="checkCliente" checked onchange="updateCalc()">
                                <div class="checkbox-content">
                                    <span class="checkbox-title">Cliente de Iberdrola (luz)</span>
                                    <p class="checkbox-desc">Aplica el precio especial de Gestión MOVES III para clientes Iberdrola.</p>
                                </div>
                            </label>
                            <label class="checkbox-box">
                                <input type="checkbox" id="checkPromoPack" onchange="updateCalc()">
                                <div class="checkbox-content">
                                    <span class="checkbox-title">Aplicar oferta 10 % PR + instalación + extras</span>
                                    <p class="checkbox-desc">Para aplicar esta promoción es <strong>obligatorio contratar i+Pack Mobility // Permanencia 1 año</strong>. Al entrar en ese colectivo se activa el 10 % y el descuento adicional de 100 € (IVA incl.) sobre MOVES base 199 €.</p>
                                </div>
                            </label>
                        </div>

                        <h3 class="extras-title">Extras</h3>

                        <label class="checkbox-box extra-moves">
                            <input type="checkbox" id="checkMoves" checked onchange="updateCalc()">
                            <div class="checkbox-content">
                                <span class="checkbox-title">Gestión MOVES III</span>
                                <p class="checkbox-desc">Tramitación completa de la subvención.</p>
                                <p class="checkbox-price" id="precioMovesLinea">+199,00 €</p>
                            </div>
                        </label>

                        <label class="checkbox-box extra-manguera">
                            <input type="checkbox" id="checkManguera" checked onchange="updateCalc()">
                            <div class="checkbox-content">
                                <span class="checkbox-title">Versión 7 m (manguera larga)</span>
                                <p class="checkbox-desc">En Pulsar Max convierte el equipo en versión 7 m. <strong>No disponible con Vestel.</strong></p>
                                <p class="checkbox-price" id="precioMangueraLinea">+0,00 € (incluido en Pulsar 7 m)</p>
                            </div>
                        </label>

                        <label class="checkbox-box extra-ipack">
                            <input type="checkbox" id="checkIPack" checked onchange="updateCalc()">
                            <div class="checkbox-content">
                                <span class="checkbox-title">i+Pack Mobility</span>
                                <p class="checkbox-desc">Servicio de averías PR + coche sustitución + traslados + 20 % recarga pública 1 año. <strong>Obligatorio para activar la promo del 10 % (colectivo i+Pack).</strong> No se suma al presupuesto del simulador; es un servicio mensual aparte.</p>
                                <p class="checkbox-price price-note-blue">12,95 €/mes + IVA (no incluido en el total)</p>
                            </div>
                        </label>

                        <div class="accordion" id="accordionSSAA">
                            <button type="button" class="accordion-header" id="accordionToggle" aria-expanded="false" aria-controls="ssaaBody" onclick="toggleSSAA()">
                                <span>Servicios i+Mobility (opcionales)</span>
                                <span class="accordion-icon">▶</span>
                            </button>
                            <div class="accordion-body" id="ssaaBody">
                                <p class="checkbox-desc paragraph-spaced">Resumen orientativo de los servicios i+Mobility asociados a Smart Mobility Hogar. No modifican el importe de este simulador.</p>
                                <div class="ssaa-grid">
                                    <div class="ssaa-item">
                                        <div class="ssaa-title">i+Repair Mobility</div>
                                        <div class="ssaa-tagline">2,95 €/mes + impuestos · Carencia 1 mes</div>
                                        <ul class="ssaa-list">
                                            <li>Servicio de reparación del PR en avería mecánica, electrónica o eléctrica interna, daños vandálicos o robo.</li>
                                            <li>Incluye desplazamiento, mano de obra y piezas hasta 300 €/año para PR de hasta 10 años.</li>
                                            <li>Sin límite de intervenciones mientras no se supere el límite anual.</li>
                                            <li>En PR de más de 10 años cubre desplazamiento y 3 h de mano de obra (piezas a cargo del cliente).</li>
                                            <li>Cubre incidencias típicas no cubiertas por garantía: tirón de manguera, carcasa rota, intento de robo, etc.</li>
                                        </ul>
                                    </div>
                                    <div class="ssaa-item">
                                        <div class="ssaa-title">i+Help Mobility</div>
                                        <div class="ssaa-tagline">11,95 €/mes + impuestos · Carencia 1 mes</div>
                                        <ul class="ssaa-list">
                                            <li>Solución vacaciones: coche de sustitución (eléctrico o combustión, grupo C/ECO, 5 plazas) hasta 15 días/año, en máximo 2 periodos.</li>
                                            <li>Solicitud con al menos 15 días de antelación.</li>
                                            <li>Traslado del beneficiario si no se ha podido cargar el VE por fallo del equipo o del sistema de recarga (taxi/VTC hasta 100 €/año).</li>
                                        </ul>
                                    </div>
                                    <div class="ssaa-item">
                                        <div class="ssaa-title">i+Pack Mobility</div>
                                        <div class="ssaa-tagline">12,95 €/mes + impuestos · Carencia 1 mes</div>
                                        <ul class="ssaa-list">
                                            <li>Incluye todas las coberturas de i+Repair Mobility (avería del PR con límite de 300 €/año).</li>
                                            <li>Incluye todas las coberturas de i+Help Mobility (coche vacacional y traslado del beneficiario hasta 100 €/año).</li>
                                            <li>20 % de descuento en recarga pública Iberdrola durante el primer año en puntos ventajosos.</li>
                                            <li>Promociones habituales: meses iniciales bonificados según oferta vigente.</li>
                                            <li>Periodo de carencia de 30 días y permanencia de 1 año si se utiliza la Solución Vacaciones.</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                    <div class="section">
                        <h2 class="section-title">Presupuesto</h2>
                        <section class="result-box result-region" aria-live="polite" aria-label="Resumen de presupuesto">
                            <div class="result-label">Importe estimado Smart Mobility Hogar</div>
                            <div class="result-price" id="precioTotal"></div>
                            <div class="result-subtitle">IVA 21 % incluido</div>
                            <div class="result-breakdown">
                                <div class="result-row"><span>Base imponible (sin IVA)</span><span id="precioSinIva"></span></div>
                                <div class="result-row"><span>IVA 21 %</span><span id="precioIva"></span></div>
                                <div class="result-row"><span class="result-total-label">Total con IVA</span><span id="precioTotalResumen" class="result-total-value"></span></div>
                            </div>
                            <div id="triNote" class="trifasico-note" role="status" aria-live="polite">Pulsar Max trifásico seleccionado: la instalación se presupuesta in situ y no se incluye en este simulador.</div>
                            <div class="promo-box" id="promoBox">
                                <strong>Oferta 10 % PR + instalación + extras activa.</strong><br>
                                Incluye un descuento adicional de <strong>100 € (IVA incl.)</strong> sobre MOVES base 199 €.
                            </div>
                            <div class="cashback-box">
                                <strong>Cashback Smart Mobility Hogar:</strong><br>
                                500 € en saldo Mi Iberdrola (8,33 €/mes durante 5 años). No se descuenta de este presupuesto.
                            </div>
                        </section>

                        <div class="desglose-box">
                            <h3 class="desglose-title">Desglose de conceptos (sin IVA)</h3>
                            <div class="desglose-items" id="desglose"></div>
                        </div>
                    </div>
                </div>
            </main>
        </div>

        <script src="scripts.js"></script>
</body>
</html>
